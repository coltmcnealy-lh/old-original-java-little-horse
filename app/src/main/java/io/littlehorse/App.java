/*
 * This Java source file was generated by the Gradle 'init' task.
 */
package io.littlehorse;

import java.util.Arrays;
import org.apache.kafka.clients.admin.NewTopic;
import com.fasterxml.jackson.dataformat.avro.AvroMapper;
import com.fasterxml.jackson.dataformat.avro.AvroSchema;
import com.fasterxml.jackson.dataformat.avro.schema.AvroSchemaGenerator;
import io.littlehorse.common.LHConfig;
import io.littlehorse.scheduler.Scheduler;

class Foo {
    public int bar;
}

public class App {

    public static void experiment() throws Exception {
        AvroSchemaGenerator gen = new AvroSchemaGenerator();
        AvroMapper mapper = new AvroMapper();
        mapper.acceptJsonFormatVisitor(Foo.class, gen);

        AvroSchema schema = gen.getGeneratedSchema();

        String data = "{\"bar\": 5432}";
        Foo f = mapper.readerFor(Foo.class).with(schema).readValue(data.getBytes());
        System.out.println(f);
        System.out.println(f.bar);
    }

    public static void doMain(String[] args) throws Exception {
        LHConfig conf = new LHConfig();
        Scheduler.run(conf);
    }

    public static void main(String[] args) throws Exception {
        // experiment();
        doMain(args);
    }
}
